<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal de Procedimentos - Victa</title>
    <style>
        /* ... (mantenha todo o CSS existente) ... */

        /* Novos estilos adicionados */
        .admin-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-edit {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-delete {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-edit:hover, .btn-delete:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5em;
            color: #0a4d3a;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: flex-end;
        }

        .btn-cancel {
            background: #95a5a6;
            color: white;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            margin-left: 10px;
        }

        .status-active {
            background: rgba(0, 255, 136, 0.15);
            color: #0a4d3a;
        }

        .status-inactive {
            background: rgba(231, 76, 60, 0.15);
            color: #c0392b;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìã Portal de Procedimentos</h1>
            <p>Consulte rapidamente todos os procedimentos da equipe</p>
        </div>

        <div class="search-section">
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Digite para buscar procedimentos... (ex: boleto, planta, contrato)" id="searchInput">
                <span class="search-icon">üîç</span>
            </div>
            <div class="quick-filters">
                <button class="filter-tag" onclick="filterProcedures('all')">Todos</button>
                <button class="filter-tag" onclick="filterProcedures('financeiro')">Financeiro</button>
                <button class="filter-tag" onclick="filterProcedures('documentos')">Documentos</button>
                <button class="filter-tag" onclick="filterProcedures('obras')">Obras</button>
                <button class="filter-tag" onclick="filterProcedures('portal')">Portal</button>
                <button class="filter-tag" onclick="toggleAdminMode()" id="adminModeToggle">üîì Modo Administrativo</button>
            </div>
        </div>

        <div id="proceduresContainer" class="procedures-grid">
            <!-- Procedimentos ser√£o inseridos aqui dinamicamente -->
        </div>

        <div id="noResults" class="no-results" style="display: none;">
            <h3>üîç Nenhum procedimento encontrado</h3>
            <p>Tente usar palavras-chave diferentes ou navegue pelas categorias</p>
        </div>

        <div class="admin-section">
            <button class="admin-toggle" onclick="toggleAdminForm()">‚ûï Adicionar Novo Procedimento</button>
            <div id="adminForm" class="admin-form">
                <input type="hidden" id="procId" value="">
                <div class="form-group half">
                    <label class="form-label">T√≠tulo do Procedimento</label>
                    <input type="text" class="form-input" id="procTitle" placeholder="Ex: Boletos em Atraso">
                </div>
                <div class="form-group half">
                    <label class="form-label">Categoria</label>
                    <input type="text" class="form-input" id="procCategory" placeholder="Ex: financeiro, documentos, obras">
                </div>
                <div class="form-group">
                    <label class="form-label">Resumo (aparece no card)</label>
                    <input type="text" class="form-input" id="procSummary" placeholder="Breve descri√ß√£o do procedimento">
                </div>
                <div class="form-group">
                    <label class="form-label">Procedimento Completo</label>
                    <textarea class="form-textarea" id="procDetails" placeholder="Descreva o procedimento completo com todos os passos..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Tags (separadas por v√≠rgula)</label>
                    <input type="text" class="form-input" id="procTags" placeholder="Ex: boleto, pagamento, vencimento, multa">
                </div>
                <div class="form-group">
                    <button class="btn-primary" id="submitButton" onclick="saveProcedure()">Adicionar Procedimento</button>
                    <button class="btn-cancel" onclick="resetForm()" style="margin-left: 10px;">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirma√ß√£o -->
    <div class="modal" id="confirmationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Confirma√ß√£o</h3>
                <button class="close-modal" onclick="closeModal()">√ó</button>
            </div>
            <p id="modalMessage">Tem certeza que deseja excluir este procedimento?</p>
            <div class="modal-buttons">
                <button class="btn-cancel" onclick="closeModal()">Cancelar</button>
                <button class="btn-delete" id="confirmActionButton">Confirmar</button>
            </div>
        </div>
    </div>

    <script>
        // Dados iniciais baseados no documento fornecido
        let procedures = [
            {
                id: 1,
                title: "Boletos",
                icon: "üí≥",
                category: "financeiro",
                summary: "Envio autom√°tico, boletos vencidos, antecipa√ß√£o de valores e gera√ß√£o de novos documentos.",
                details: `<strong>Envio Autom√°tico:</strong><br>
                ‚Ä¢ Boletos s√£o enviados 10 dias antes do vencimento via relacionamento@victa.eng.br<br>
                ‚Ä¢ Dispon√≠vel no portal do cliente ap√≥s gera√ß√£o<br><br>
                
                <strong>Boleto Vencido:</strong><br>
                ‚Ä¢ Pode ser pago at√© o final do m√™s vigente<br>
                ‚Ä¢ Banco calcula juros e multa automaticamente<br>
                ‚Ä¢ Ap√≥s virar o m√™s, solicitar novo documento<br><br>
                
                <strong>Importantes:</strong><br>
                ‚Ä¢ N√£o temos concess√£o de isen√ß√£o de juros/multa<br>
                ‚Ä¢ Para negocia√ß√£o de d√≠vida, encaminhar para cobran√ßa<br>
                ‚Ä¢ Antecipa√ß√£o: sempre das parcelas mais antigas<br>
                ‚Ä¢ Aguardar ajuste INCC ap√≥s mudan√ßa de m√™s<br>
                ‚Ä¢ Contratos com m√∫ltiplos titulares geram boletos proporcionais`,
                tags: ["boleto", "pagamento", "vencimento", "juros", "multa", "antecipa√ß√£o", "INCC"],
                active: true
            },
            // ... (os outros procedimentos permanecem com active: true)
        ];

        let filteredProcedures = [...procedures];
        let adminMode = false;
        let currentProcedureId = null;

        function renderProcedures() {
            const container = document.getElementById('proceduresContainer');
            const noResults = document.getElementById('noResults');
            
            if (filteredProcedures.filter(p => p.active).length === 0) {
                container.innerHTML = '';
                noResults.style.display = 'block';
                return;
            }
            
            noResults.style.display = 'none';
            
            container.innerHTML = filteredProcedures.filter(p => p.active).map(proc => `
                <div class="procedure-card" onclick="toggleDetails(${proc.id})">
                    <div class="procedure-title">
                        <div class="procedure-icon">${proc.icon}</div>
                        ${proc.title}
                        ${!proc.active ? '<span class="status-badge status-inactive">Desativado</span>' : 
                          '<span class="status-badge status-active">Ativo</span>'}
                    </div>
                    <div class="procedure-summary">${proc.summary}</div>
                    <div class="procedure-tags">
                        ${proc.tags.slice(0, 3).map(tag => `<span class="tag">${tag}</span>`).join('')}
                        ${proc.tags.length > 3 ? `<span class="tag">+${proc.tags.length - 3}</span>` : ''}
                    </div>
                    <div class="procedure-details" id="details-${proc.id}">
                        ${proc.details}
                    </div>
                    
                    ${adminMode ? `
                    <div class="admin-actions">
                        <button class="btn-edit" onclick="editProcedure(${proc.id}, event)">Editar</button>
                        <button class="btn-delete" onclick="confirmDelete(${proc.id}, event)">Excluir</button>
                    </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // Fun√ß√£o para alternar o modo administrativo
        function toggleAdminMode() {
            adminMode = !adminMode;
            const toggleButton = document.getElementById('adminModeToggle');
            
            if (adminMode) {
                toggleButton.textContent = 'üîí Sair do Modo Administrativo';
                toggleButton.classList.add('active');
            } else {
                toggleButton.textContent = 'üîì Modo Administrativo';
                toggleButton.classList.remove('active');
            }
            
            renderProcedures();
        }

        // Fun√ß√£o para abrir o formul√°rio administrativo
        function toggleAdminForm() {
            const form = document.getElementById('adminForm');
            form.classList.toggle('active');
            
            if (!form.classList.contains('active')) {
                resetForm();
            }
        }

        // Fun√ß√£o para editar um procedimento
        function editProcedure(id, event) {
            event.stopPropagation(); // Impede que o card seja expandido
            const proc = procedures.find(p => p.id === id);
            
            if (proc) {
                document.getElementById('procId').value = proc.id;
                document.getElementById('procTitle').value = proc.title;
                document.getElementById('procCategory').value = proc.category;
                document.getElementById('procSummary').value = proc.summary;
                document.getElementById('procDetails').value = proc.details.replace(/<br>/g, '\n');
                document.getElementById('procTags').value = proc.tags.join(', ');
                
                document.getElementById('submitButton').textContent = 'Atualizar Procedimento';
                
                // Abrir o formul√°rio se estiver fechado
                const form = document.getElementById('adminForm');
                if (!form.classList.contains('active')) {
                    form.classList.add('active');
                }
                
                // Scroll para o formul√°rio
                form.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Fun√ß√£o para salvar um novo procedimento ou atualizar existente
        function saveProcedure() {
            const id = document.getElementById('procId').value;
            const title = document.getElementById('procTitle').value.trim();
            const category = document.getElementById('procCategory').value.trim();
            const summary = document.getElementById('procSummary').value.trim();
            const details = document.getElementById('procDetails').value.trim();
            const tags = document.getElementById('procTags').value.trim();
            
            if (!title || !category || !summary || !details) {
                alert('Por favor, preencha todos os campos obrigat√≥rios!');
                return;
            }
            
            if (id) {
                // Atualizar procedimento existente
                const index = procedures.findIndex(p => p.id === parseInt(id));
                if (index !== -1) {
                    procedures[index] = {
                        ...procedures[index],
                        title,
                        category: category.toLowerCase(),
                        summary,
                        details: details.replace(/\n/g, '<br>'),
                        tags: tags ? tags.split(',').map(tag => tag.trim().toLowerCase()) : []
                    };
                    alert('Procedimento atualizado com sucesso!');
                }
            } else {
                // Adicionar novo procedimento
                const newId = procedures.length > 0 ? Math.max(...procedures.map(p => p.id)) + 1 : 1;
                const newProcedure = {
                    id: newId,
                    title,
                    icon: "üìã",
                    category: category.toLowerCase(),
                    summary,
                    details: details.replace(/\n/g, '<br>'),
                    tags: tags ? tags.split(',').map(tag => tag.trim().toLowerCase()) : [],
                    active: true
                };
                procedures.push(newProcedure);
                alert('Procedimento adicionado com sucesso!');
            }
            
            filteredProcedures = [...procedures];
            renderProcedures();
            resetForm();
        }

        // Fun√ß√£o para resetar o formul√°rio
        function resetForm() {
            document.getElementById('procId').value = '';
            document.getElementById('procTitle').value = '';
            document.getElementById('procCategory').value = '';
            document.getElementById('procSummary').value = '';
            document.getElementById('procDetails').value = '';
            document.getElementById('procTags').value = '';
            document.getElementById('submitButton').textContent = 'Adicionar Procedimento';
        }

        // Fun√ß√£o para confirmar exclus√£o (abre modal)
        function confirmDelete(id, event) {
            event.stopPropagation();
            currentProcedureId = id;
            const proc = procedures.find(p => p.id === id);
            
            document.getElementById('modalMessage').textContent = 
                `Tem certeza que deseja ${proc.active ? 'desativar' : 'excluir permanentemente'} o procedimento "${proc.title}"?`;
                
            document.getElementById('confirmActionButton').textContent = 
                proc.active ? 'Desativar' : 'Excluir Permanentemente';
                
            document.getElementById('confirmationModal').style.display = 'flex';
        }

        // Fun√ß√£o para executar a exclus√£o/desativa√ß√£o
        function deleteProcedure() {
            const index = procedures.findIndex(p => p.id === currentProcedureId);
            
            if (index !== -1) {
                if (procedures[index].active) {
                    // Desativar (mant√©m no sistema mas n√£o mostra)
                    procedures[index].active = false;
                } else {
                    // Excluir permanentemente
                    procedures.splice(index, 1);
                }
                
                filteredProcedures = [...procedures];
                renderProcedures();
            }
            
            closeModal();
        }

        // Fun√ß√µes para gerenciar o modal
        function closeModal() {
            document.getElementById('confirmationModal').style.display = 'none';
            currentProcedureId = null;
        }

        // Configurar o bot√£o de confirma√ß√£o no modal
        document.getElementById('confirmActionButton').addEventListener('click', deleteProcedure);

        /* ... (mantenha as outras fun√ß√µes existentes) ... */

        // Inicializar
        renderProcedures();
    </script>
</body>
</html>
